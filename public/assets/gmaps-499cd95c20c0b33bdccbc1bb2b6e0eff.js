/*!
 * GMaps.js v0.2.30
 * http://hpneo.github.com/gmaps/
 *
 * Copyright 2012, Gustavo Leon
 * Released under the MIT License.
 */
if(window.google&&window.google.maps)var GMaps=function(t){"use strict";var e=document,i=function(i,n){var s;return s="jQuery"in t&&n?$("#"+i.replace("#",""),n)[0]:e.getElementById(i.replace("#",""))},n=function(t){var s=this,o=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],r=["mousemove","mouseout","mouseover"];window.context_menu={},this.el="string"==typeof t.el||"string"==typeof t.div?i(t.el||t.div,t.context):t.el||t.div,this.el.style.width=t.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=t.height||this.el.scrollHeight||this.el.offsetHeight,this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=t.zoom||13;var a,l=t.markerClusterer;a=t.mapType?google.maps.MapTypeId[t.mapType.toUpperCase()]:google.maps.MapTypeId.ROADMAP;var h=new google.maps.LatLng(t.lat,t.lng);delete t.el,delete t.lat,delete t.lng,delete t.mapType,delete t.width,delete t.height,delete t.markerClusterer;var c=t.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},u=t.zoomControl||!0,d=c.style||"DEFAULT",p=c.position||"TOP_LEFT",f=t.panControl||!0,g=t.mapTypeControl||!0,m=t.scaleControl||!0,v=t.streetViewControl||!0,y=y||!0,b={},w={zoom:this.zoom,center:h,mapTypeId:a},x={panControl:f,zoomControl:u,zoomControlOptions:{style:google.maps.ZoomControlStyle[d],position:google.maps.ControlPosition[p]},mapTypeControl:g,scaleControl:m,streetViewControl:v,overviewMapControl:y};1!=t.disableDefaultUI&&(w=extend_object(w,x)),b=extend_object(w,t);for(var k=0;k<o.length;k++)delete b[o[k]];for(var k=0;k<r.length;k++)delete b[r[k]];this.map=new google.maps.Map(this.el,b),l&&(this.markerClusterer=l.apply(this,[this.map]));var _=function(t,e){var n="",o=window.context_menu[t];for(var r in o)if(o.hasOwnProperty(r)){var a=o[r];n+='<li><a id="'+t+"_"+r+'" href="#">'+a.title+"</a></li>"}if(i("gmaps_context_menu")){var l=i("gmaps_context_menu");l.innerHTML=n;for(var h=l.getElementsByTagName("a"),c=h.length,r=0;c>r;r++){var u=h[r],d=function(i){i.preventDefault(),o[this.id.replace(t+"_","")].action.apply(s,[e]),s.hideContextMenu()};google.maps.event.clearListeners(u,"click"),google.maps.event.addDomListenerOnce(u,"click",d,!1)}var p=s.el.offsetLeft+e.pixel.x-15,f=s.el.offsetTop+e.pixel.y-15;l.style.left=p+"px",l.style.top=f+"px",l.style.display="block"}},C=function(t,e){if("marker"===t){e.pixel={};var i=new google.maps.OverlayView;i.setMap(s.map),i.draw=function(){var n=i.getProjection(),s=e.marker.getPosition();e.pixel=n.fromLatLngToContainerPixel(s),_(t,e)}}else _(t,e)};this.setContextMenu=function(t){window.context_menu[t.control]={};for(var n in t.options)if(t.options.hasOwnProperty(n)){var s=t.options[n];window.context_menu[t.control][s.name]={title:s.title,action:s.action}}var o=e.createElement("ul");o.id="gmaps_context_menu",o.style.display="none",o.style.position="absolute",o.style.minWidth="100px",o.style.background="white",o.style.listStyle="none",o.style.padding="8px",o.style.boxShadow="2px 2px 6px #ccc",e.body.appendChild(o);var r=i("gmaps_context_menu");google.maps.event.addDomListener(r,"mouseout",function(t){t.relatedTarget&&this.contains(t.relatedTarget)||window.setTimeout(function(){r.style.display="none"},400)},!1)},this.hideContextMenu=function(){var t=i("gmaps_context_menu");t&&(t.style.display="none")};for(var T=function(e,i){google.maps.event.addListener(e,i,function(e){void 0==e&&(e=this),t[i].apply(this,[e]),s.hideContextMenu()})},S=0;S<o.length;S++){var D=o[S];D in t&&T(this.map,D)}for(var S=0;S<r.length;S++){var D=r[S];D in t&&T(this.map,D)}google.maps.event.addListener(this.map,"rightclick",function(e){t.rightclick&&t.rightclick.apply(this,[e]),void 0!=window.context_menu.map&&C("map",e)}),this.refresh=function(){google.maps.event.trigger(this.map,"resize")},this.fitZoom=function(){for(var t=[],e=this.markers.length,i=0;e>i;i++)t.push(this.markers[i].getPosition());this.fitLatLngBounds(t)},this.fitLatLngBounds=function(t){for(var e=t.length,i=new google.maps.LatLngBounds,n=0;e>n;n++)i.extend(t[n]);this.map.fitBounds(i)},this.setCenter=function(t,e,i){this.map.panTo(new google.maps.LatLng(t,e)),i&&i()},this.getElement=function(){return this.el},this.zoomIn=function(t){this.zoom=this.map.getZoom()+t,this.map.setZoom(this.zoom)},this.zoomOut=function(t){this.zoom=this.map.getZoom()-t,this.map.setZoom(this.zoom)};var M=[];for(var P in this.map)"function"!=typeof this.map[P]||this[P]||M.push(P);for(var k=0;k<M.length;k++)!function(t,e,i){t[i]=function(){return e[i].apply(e,arguments)}}(this,this.map,M[k]);this.createControl=function(t){var i=e.createElement("div");i.style.cursor="pointer",i.style.fontFamily="Arial, sans-serif",i.style.fontSize="13px",i.style.boxShadow="rgba(0, 0, 0, 0.398438) 0px 2px 4px";for(var n in t.style)i.style[n]=t.style[n];t.id&&(i.id=t.id),t.classes&&(i.className=t.classes),t.content&&(i.innerHTML=t.content);for(var s in t.events)!function(e,i){google.maps.event.addDomListener(e,i,function(){t.events[i].apply(this,[this])})}(i,s);return i.index=1,i},this.addControl=function(t){var e=google.maps.ControlPosition[t.position.toUpperCase()];delete t.position;var i=this.createControl(t);return this.controls.push(i),this.map.controls[e].push(i),i},this.createMarker=function(t){if(t.hasOwnProperty("lat")&&t.hasOwnProperty("lng")||t.position){var e=this,i=t.details,n=t.fences,s=t.outside,o={position:new google.maps.LatLng(t.lat,t.lng),map:null};delete t.lat,delete t.lng,delete t.fences,delete t.outside;var r=extend_object(o,t),a=new google.maps.Marker(r);if(a.fences=n,t.infoWindow){a.infoWindow=new google.maps.InfoWindow(t.infoWindow);for(var l=["closeclick","content_changed","domready","position_changed","zindex_changed"],h=0;h<l.length;h++)!function(e,i){google.maps.event.addListener(e,i,function(e){t.infoWindow[i]&&t.infoWindow[i].apply(this,[e])})}(a.infoWindow,l[h])}for(var c=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],u=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],h=0;h<c.length;h++)!function(e,i){google.maps.event.addListener(e,i,function(){t[i]&&t[i].apply(this,[this])})}(a,c[h]);for(var h=0;h<u.length;h++)!function(e,i,n){google.maps.event.addListener(i,n,function(i){i.pixel||(i.pixel=e.getProjection().fromLatLngToPoint(i.latLng)),t[n]&&t[n].apply(this,[i])})}(this.map,a,u[h]);return google.maps.event.addListener(a,"click",function(){this.details=i,t.click&&t.click.apply(this,[this]),a.infoWindow&&(e.hideInfoWindows(),a.infoWindow.open(e.map,a))}),google.maps.event.addListener(a,"rightclick",function(e){e.marker=this,t.rightclick&&t.rightclick.apply(this,[e]),void 0!=window.context_menu.marker&&C("marker",e)}),(t.dragend||a.fences)&&google.maps.event.addListener(a,"dragend",function(){a.fences&&e.checkMarkerGeofence(a,function(t,e){s(t,e)})}),a}throw"No latitude or longitude defined"},this.addMarker=function(t){var e;if(t.hasOwnProperty("gm_accessors_"))e=t;else{if(!(t.hasOwnProperty("lat")&&t.hasOwnProperty("lng")||t.position))throw"No latitude or longitude defined";e=this.createMarker(t)}return e.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(e),this.markers.push(e),e},this.addMarkers=function(t){for(var e,i=0;e=t[i];i++)this.addMarker(e);return this.markers},this.hideInfoWindows=function(){for(var t,e=0;t=this.markers[e];e++)t.infoWindow&&t.infoWindow.close()},this.removeMarker=function(t){for(var e=0;e<this.markers.length;e++)if(this.markers[e]===t){this.markers[e].setMap(null),this.markers.splice(e,1);break}return t},this.removeMarkers=function(t){for(var t=t||this.markers,e=0;e<this.markers.length;e++)this.markers[e]===t[e]&&this.markers[e].setMap(null);for(var i=[],e=0;e<this.markers.length;e++)null!=this.markers[e].getMap()&&i.push(this.markers[e]);this.markers=i},this.drawOverlay=function(t){var i=new google.maps.OverlayView;i.setMap(s.map);var n=!0;return null!=t.auto_show&&(n=t.auto_show),i.onAdd=function(){var n=e.createElement("div");n.style.borderStyle="none",n.style.borderWidth="0px",n.style.position="absolute",n.style.zIndex=100,n.innerHTML=t.content,i.el=n;var s=this.getPanes();t.layer||(t.layer="overlayLayer");var o=s[t.layer];o.appendChild(n);for(var r=["contextmenu","DOMMouseScroll","dblclick","mousedown"],a=0;a<r.length;a++)!function(t,e){google.maps.event.addDomListener(t,e,function(t){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&document.all?(t.cancelBubble=!0,t.returnValue=!1):t.stopPropagation()})}(n,r[a]);google.maps.event.trigger(this,"ready")},i.draw=function(){var e=this.getProjection(),s=e.fromLatLngToDivPixel(new google.maps.LatLng(t.lat,t.lng));t.horizontalOffset=t.horizontalOffset||0,t.verticalOffset=t.verticalOffset||0;var o=i.el,r=o.children[0],a=r.clientHeight,l=r.clientWidth;switch(t.verticalAlign){case"top":o.style.top=s.y-a+t.verticalOffset+"px";break;default:case"middle":o.style.top=s.y-a/2+t.verticalOffset+"px";break;case"bottom":o.style.top=s.y+t.verticalOffset+"px"}switch(t.horizontalAlign){case"left":o.style.left=s.x-l+t.horizontalOffset+"px";break;default:case"center":o.style.left=s.x-l/2+t.horizontalOffset+"px";break;case"right":o.style.left=s.x+t.horizontalOffset+"px"}o.style.display=n?"block":"none",n||t.show.apply(this,[o])},i.onRemove=function(){var e=i.el;t.remove?t.remove.apply(this,[e]):(i.el.parentNode.removeChild(i.el),i.el=null)},s.overlays.push(i),i},this.removeOverlay=function(t){for(var e=0;e<this.overlays.length;e++)if(this.overlays[e]===t){this.overlays[e].setMap(null),this.overlays.splice(e,1);break}},this.removeOverlays=function(){for(var t,e=0;t=s.overlays[e];e++)t.setMap(null);s.overlays=[]},this.drawPolyline=function(t){var e=[],i=t.path;if(i.length)if(void 0===i[0][0])e=i;else for(var n,s=0;n=i[s];s++)e.push(new google.maps.LatLng(n[0],n[1]));var o={map:this.map,path:e,strokeColor:t.strokeColor,strokeOpacity:t.strokeOpacity,strokeWeight:t.strokeWeight,geodesic:t.geodesic,clickable:!0,editable:!1,visible:!0};t.hasOwnProperty("clickable")&&(o.clickable=t.clickable),t.hasOwnProperty("editable")&&(o.editable=t.editable),t.hasOwnProperty("icons")&&(o.icons=t.icons),t.hasOwnProperty("zIndex")&&(o.zIndex=t.zIndex);for(var r=new google.maps.Polyline(o),a=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],l=0;l<a.length;l++)!function(e,i){google.maps.event.addListener(e,i,function(e){t[i]&&t[i].apply(this,[e])})}(r,a[l]);return this.polylines.push(r),r},this.removePolyline=function(t){for(var e=0;e<this.polylines.length;e++)if(this.polylines[e]===t){this.polylines[e].setMap(null),this.polylines.splice(e,1);break}},this.removePolylines=function(){for(var t,e=0;t=s.polylines[e];e++)t.setMap(null);s.polylines=[]},this.drawCircle=function(t){t=extend_object({map:this.map,center:new google.maps.LatLng(t.lat,t.lng)},t),delete t.lat,delete t.lng;for(var e=new google.maps.Circle(t),i=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],n=0;n<i.length;n++)!function(e,i){google.maps.event.addListener(e,i,function(e){t[i]&&t[i].apply(this,[e])})}(e,i[n]);return this.polygons.push(e),e},this.drawRectangle=function(t){t=extend_object({map:this.map},t);var e=new google.maps.LatLngBounds(new google.maps.LatLng(t.bounds[0][0],t.bounds[0][1]),new google.maps.LatLng(t.bounds[1][0],t.bounds[1][1]));t.bounds=e;for(var i=new google.maps.Rectangle(t),n=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],s=0;s<n.length;s++)!function(e,i){google.maps.event.addListener(e,i,function(e){t[i]&&t[i].apply(this,[e])})}(i,n[s]);return this.polygons.push(i),i},this.drawPolygon=function(t){var e=!1;t.hasOwnProperty("useGeoJSON")&&(e=t.useGeoJSON),delete t.useGeoJSON,t=extend_object({map:this.map},t),0==e&&(t.paths=[t.paths.slice(0)]),t.paths.length>0&&t.paths[0].length>0&&(t.paths=array_flat(array_map(t.paths,arrayToLatLng,e)));for(var i=new google.maps.Polygon(t),n=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],s=0;s<n.length;s++)!function(e,i){google.maps.event.addListener(e,i,function(e){t[i]&&t[i].apply(this,[e])})}(i,n[s]);return this.polygons.push(i),i},this.removePolygon=function(t){for(var e=0;e<this.polygons.length;e++)if(this.polygons[e]===t){this.polygons[e].setMap(null),this.polygons.splice(e,1);break}},this.removePolygons=function(){for(var t,e=0;t=s.polygons[e];e++)t.setMap(null);s.polygons=[]},this.getFromFusionTables=function(t){var e=t.events;delete t.events;var i=t,n=new google.maps.FusionTablesLayer(i);for(var s in e)!function(t,i){google.maps.event.addListener(t,i,function(t){e[i].apply(this,[t])})}(n,s);return this.layers.push(n),n},this.loadFromFusionTables=function(t){var e=this.getFromFusionTables(t);return e.setMap(this.map),e},this.getFromKML=function(t){var e=t.url,i=t.events;delete t.url,delete t.events;var n=t,s=new google.maps.KmlLayer(e,n);for(var o in i)!function(t,e){google.maps.event.addListener(t,e,function(t){i[e].apply(this,[t])})}(s,o);return this.layers.push(s),s},this.loadFromKML=function(t){var e=this.getFromKML(t);return e.setMap(this.map),e};var L,A;this.getRoutes=function(t){switch(t.travelMode){case"bicycling":L=google.maps.TravelMode.BICYCLING;break;case"transit":L=google.maps.TravelMode.TRANSIT;break;case"driving":L=google.maps.TravelMode.DRIVING;break;default:L=google.maps.TravelMode.WALKING}A="imperial"===t.unitSystem?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;var e={avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]},i=extend_object(e,t);i.origin=new google.maps.LatLng(t.origin[0],t.origin[1]),i.destination=new google.maps.LatLng(t.destination[0],t.destination[1]),i.travelMode=L,i.unitSystem=A,delete i.callback;var n=this,s=new google.maps.DirectionsService;s.route(i,function(e,i){if(i===google.maps.DirectionsStatus.OK)for(var s in e.routes)e.routes.hasOwnProperty(s)&&n.routes.push(e.routes[s]);t.callback&&t.callback(n.routes)})},this.removeRoutes=function(){this.routes=[]},this.getElevations=function(t){t=extend_object({locations:[],path:!1,samples:256},t),t.locations.length>0&&t.locations[0].length>0&&(t.locations=array_flat(array_map([t.locations],arrayToLatLng,!1)));var e=t.callback;delete t.callback;var i=new google.maps.ElevationService;if(t.path){var n={path:t.locations,samples:t.samples};i.getElevationAlongPath(n,function(t,i){e&&"function"==typeof e&&e(t,i)})}else delete t.path,delete t.samples,i.getElevationForLocations(t,function(t,i){e&&"function"==typeof e&&e(t,i)})},this.cleanRoute=this.removePolylines,this.drawRoute=function(t){var e=this;this.getRoutes({origin:t.origin,destination:t.destination,travelMode:t.travelMode,waypoints:t.waypoints,unitSystem:t.unitSystem,callback:function(i){i.length>0&&(e.drawPolyline({path:i[i.length-1].overview_path,strokeColor:t.strokeColor,strokeOpacity:t.strokeOpacity,strokeWeight:t.strokeWeight}),t.callback&&t.callback(i[i.length-1]))}})},this.travelRoute=function(t){if(t.origin&&t.destination)this.getRoutes({origin:t.origin,destination:t.destination,travelMode:t.travelMode,waypoints:t.waypoints,callback:function(e){if(e.length>0&&t.start&&t.start(e[e.length-1]),e.length>0&&t.step){var i=e[e.length-1];if(i.legs.length>0)for(var n,s=i.legs[0].steps,o=0;n=s[o];o++)n.step_number=o,t.step(n,i.legs[0].steps.length-1)}e.length>0&&t.end&&t.end(e[e.length-1])}});else if(t.route&&t.route.legs.length>0)for(var e,i=t.route.legs[0].steps,n=0;e=i[n];n++)e.step_number=n,t.step(e)},this.drawSteppedRoute=function(t){if(t.origin&&t.destination)this.getRoutes({origin:t.origin,destination:t.destination,travelMode:t.travelMode,waypoints:t.waypoints,callback:function(e){if(e.length>0&&t.start&&t.start(e[e.length-1]),e.length>0&&t.step){var i=e[e.length-1];if(i.legs.length>0)for(var n,o=i.legs[0].steps,r=0;n=o[r];r++)n.step_number=r,s.drawPolyline({path:n.path,strokeColor:t.strokeColor,strokeOpacity:t.strokeOpacity,strokeWeight:t.strokeWeight}),t.step(n,i.legs[0].steps.length-1)}e.length>0&&t.end&&t.end(e[e.length-1])}});else if(t.route&&t.route.legs.length>0)for(var e,i=t.route.legs[0].steps,n=0;e=i[n];n++)e.step_number=n,s.drawPolyline({path:e.path,strokeColor:t.strokeColor,strokeOpacity:t.strokeOpacity,strokeWeight:t.strokeWeight}),t.step(e)},this.checkGeofence=function(t,e,i){return i.containsLatLng(new google.maps.LatLng(t,e))},this.checkMarkerGeofence=function(t,e){if(t.fences)for(var i,n=0;i=t.fences[n];n++){var o=t.getPosition();s.checkGeofence(o.lat(),o.lng(),i)||e(t,i)}},this.addLayer=function(t,e){e=e||{};var i;switch(t){case"weather":this.singleLayers.weather=i=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=i=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=i=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=i=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=i=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=i=new google.maps.panoramio.PanoramioLayer,i.setTag(e.filter),delete e.filter,e.click&&google.maps.event.addListener(i,"click",function(t){e.click(t),delete e.click});break;case"places":if(this.singleLayers.places=i=new google.maps.places.PlacesService(this.map),e.search||e.nearbySearch){var n={bounds:e.bounds||null,keyword:e.keyword||null,location:e.location||null,name:e.name||null,radius:e.radius||null,rankBy:e.rankBy||null,types:e.types||null};e.search&&i.search(n,e.search),e.nearbySearch&&i.nearbySearch(n,e.nearbySearch)}if(e.textSearch){var s={bounds:e.bounds||null,location:e.location||null,query:e.query||null,radius:e.radius||null};i.textSearch(s,e.textSearch)}}return void 0!==i?("function"==typeof i.setOptions&&i.setOptions(e),"function"==typeof i.setMap&&i.setMap(this.map),i):void 0},this.removeLayer=function(t){void 0!==this.singleLayers[t]&&(this.singleLayers[t].setMap(null),delete this.singleLayers[t])},this.toImage=function(t){var t=t||{},e={};if(e.size=t.size||[this.el.clientWidth,this.el.clientHeight],e.lat=this.getCenter().lat(),e.lng=this.getCenter().lng(),this.markers.length>0){e.markers=[];for(var i=0;i<this.markers.length;i++)e.markers.push({lat:this.markers[i].getPosition().lat(),lng:this.markers[i].getPosition().lng()})}if(this.polylines.length>0){var s=this.polylines[0];e.polyline={},e.polyline.path=google.maps.geometry.encoding.encodePath(s.getPath()),e.polyline.strokeColor=s.strokeColor,e.polyline.strokeOpacity=s.strokeOpacity,e.polyline.strokeWeight=s.strokeWeight}return n.staticMapURL(e)},this.addMapType=function(t,e){if(!e.hasOwnProperty("getTileUrl")||"function"!=typeof e.getTileUrl)throw"'getTileUrl' function required";e.tileSize=e.tileSize||new google.maps.Size(256,256);var i=new google.maps.ImageMapType(e);this.map.mapTypes.set(t,i)},this.addOverlayMapType=function(t){if(!t.hasOwnProperty("getTile")||"function"!=typeof t.getTile)throw"'getTile' function required";var e=t.index;delete t.index,this.map.overlayMapTypes.insertAt(e,t)},this.removeOverlayMapType=function(t){this.map.overlayMapTypes.removeAt(t)},this.addStyle=function(t){var e=new google.maps.StyledMapType(t.styles,t.styledMapName);this.map.mapTypes.set(t.mapTypeId,e)},this.setStyle=function(t){this.map.setMapTypeId(t)},this.createPanorama=function(t){return t.hasOwnProperty("lat")&&t.hasOwnProperty("lng")||(t.lat=this.getCenter().lat(),t.lng=this.getCenter().lng()),this.panorama=n.createPanorama(t),this.map.setStreetView(this.panorama),this.panorama}};return n.createPanorama=function(t){var e=i(t.el,t.context);t.position=new google.maps.LatLng(t.lat,t.lng),delete t.el,delete t.context,delete t.lat,delete t.lng;for(var n=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],s=extend_object({visible:!0},t),o=0;o<n.length;o++)delete s[n[o]];for(var r=new google.maps.StreetViewPanorama(e,s),o=0;o<n.length;o++)!function(e,i){google.maps.event.addListener(e,i,function(){t[i]&&t[i].apply(this)})}(r,n[o]);return r},n.Route=function(t){this.map=t.map,this.route=t.route,this.step_count=0,this.steps=this.route.legs[0].steps,this.steps_length=this.steps.length,this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray,strokeColor:t.strokeColor,strokeOpacity:t.strokeOpacity,strokeWeight:t.strokeWeight}).getPath(),this.back=function(){if(this.step_count>0){this.step_count--;var t=this.route.legs[0].steps[this.step_count].path;for(var e in t)t.hasOwnProperty(e)&&this.polyline.pop()}},this.forward=function(){if(this.step_count<this.steps_length){var t=this.route.legs[0].steps[this.step_count].path;for(var e in t)t.hasOwnProperty(e)&&this.polyline.push(t[e]);this.step_count++}}},n.geolocate=function(t){var e=t.always||t.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(i){t.success(i),e&&e()},function(i){t.error(i),e&&e()},t.options):(t.not_supported(),e&&e())},n.geocode=function(t){this.geocoder=new google.maps.Geocoder;var e=t.callback;t.hasOwnProperty("lat")&&t.hasOwnProperty("lng")&&(t.latLng=new google.maps.LatLng(t.lat,t.lng)),delete t.lat,delete t.lng,delete t.callback,this.geocoder.geocode(t,function(t,i){e(t,i)})},n.staticMapURL=function(t){function e(t,e){if("#"===t[0]&&(t=t.replace("#","0x"),e)){if(e=parseFloat(e),e=Math.min(1,Math.max(e,0)),0===e)return"0x00000000";e=(255*e).toString(16),1===e.length&&(e+=e),t=t.slice(0,8)+e}return t}var i,n=[],s="http://maps.googleapis.com/maps/api/staticmap";t.url&&(s=t.url,delete t.url),s+="?";var o=t.markers;delete t.markers,!o&&t.marker&&(o=[t.marker],delete t.marker);var r=t.polyline;if(delete t.polyline,t.center)n.push("center="+t.center),delete t.center;else if(t.address)n.push("center="+t.address),delete t.address;else if(t.lat)n.push(["center=",t.lat,",",t.lng].join("")),delete t.lat,delete t.lng;else if(t.visible){var a=encodeURI(t.visible.join("|"));n.push("visible="+a)}var l=t.size;l?(l.join&&(l=l.join("x")),delete t.size):l="630x300",n.push("size="+l),t.zoom||(t.zoom=15);var h=t.hasOwnProperty("sensor")?!!t.sensor:!0;delete t.sensor,n.push("sensor="+h);for(var c in t)t.hasOwnProperty(c)&&n.push(c+"="+t[c]);if(o)for(var u,d,p=0;i=o[p];p++)u=[],i.size&&"normal"!==i.size?u.push("size:"+i.size):i.icon&&u.push("icon:"+encodeURI(i.icon)),i.color&&u.push("color:"+i.color.replace("#","0x")),i.label&&u.push("label:"+i.label[0].toUpperCase()),d=i.address?i.address:i.lat+","+i.lng,u.length||0===p?(u.push(d),u=u.join("|"),n.push("markers="+encodeURI(u))):(u=n.pop()+encodeURI("|"+d),n.push(u));if(r){if(i=r,r=[],i.strokeWeight&&r.push("weight:"+parseInt(i.strokeWeight,10)),i.strokeColor){var f=e(i.strokeColor,i.strokeOpacity);r.push("color:"+f)}if(i.fillColor){var g=e(i.fillColor,i.fillOpacity);r.push("fillcolor:"+g)}var m=i.path;if(m.join)for(var v,y=0;v=m[y];y++)r.push(v.join(","));else r.push("enc:"+m);r=r.join("|"),n.push("path="+encodeURI(r))}return n=n.join("&"),s+n},google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(){for(var t,e=new google.maps.LatLngBounds,i=this.getPaths(),n=0;n<i.getLength();n++){t=i.getAt(n);for(var s=0;s<t.getLength();s++)e.extend(t.getAt(s))}return e}),google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(t){var e=this.getBounds();if(null!==e&&!e.contains(t))return!1;for(var i=!1,n=this.getPaths().getLength(),s=0;n>s;s++)for(var o=this.getPaths().getAt(s),r=o.getLength(),a=r-1,l=0;r>l;l++){var h=o.getAt(l),c=o.getAt(a);(h.lng()<t.lng()&&c.lng()>=t.lng()||c.lng()<t.lng()&&h.lng()>=t.lng())&&h.lat()+(t.lng()-h.lng())/(c.lng()-h.lng())*(c.lat()-h.lat())<t.lat()&&(i=!i),a=l}return i}),google.maps.LatLngBounds.prototype.containsLatLng=function(t){return this.contains(t)},google.maps.Marker.prototype.setFences=function(t){this.fences=t},google.maps.Marker.prototype.addFence=function(t){this.fences.push(t)},n}(this),coordsToLatLngs=function(t,e){var i=t[0],n=t[1];return e&&(i=t[1],n=t[0]),new google.maps.LatLng(i,n)},arrayToLatLng=function(t,e){for(var i=0;i<t.length;i++)t[i]=t[i].length>0&&"number"!=typeof t[i][0]?arrayToLatLng(t[i],e):coordsToLatLngs(t[i],e);return t},extend_object=function(t,e){if(t===e)return t;for(var i in e)t[i]=e[i];return t},replace_object=function(t,e){if(t===e)return t;for(var i in e)void 0!=t[i]&&(t[i]=e[i]);return t},array_map=function(t,e){var i=Array.prototype.slice.call(arguments,2);if(Array.prototype.map&&t.map===Array.prototype.map)return Array.prototype.map.call(t,function(t){return callback_params=i,callback_params.splice(0,0,t),e.apply(this,callback_params)});for(var n=[],s=t.length,o=0;s>o;o++)callback_params=i,callback_params=callback_params.splice(0,0,t[o]),n.push(e.apply(this,callback_params));return n},array_flat=function(t){new_array=[];for(var e=0;e<t.length;e++)new_array=new_array.concat(t[e]);return new_array};